# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: Arbitrary `from` Passed to `transferFrom`](#h-1-arbitrary-from-passed-to-transferfrom)
  - [H-2: Unprotected initializer](#h-2-unprotected-initializer)
  - [H-3: Incorrect Assembly Shift Parameter Order](#h-3-incorrect-assembly-shift-parameter-order)
  - [H-4: Contract Name Reused in Different Files](#h-4-contract-name-reused-in-different-files)
  - [H-5: Yul block contains `return`](#h-5-yul-block-contains-return)
  - [H-6: Contract locks Ether without a withdraw function](#h-6-contract-locks-ether-without-a-withdraw-function)
  - [H-7: Reentrancy: State change after external call](#h-7-reentrancy-state-change-after-external-call)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk](#l-1-centralization-risk)
  - [L-2: `ecrecover` Signature Malleability](#l-2-ecrecover-signature-malleability)
  - [L-3: Unsafe ERC20 Operation](#l-3-unsafe-erc20-operation)
  - [L-4: Unspecific Solidity Pragma](#l-4-unspecific-solidity-pragma)
  - [L-5: Address State Variable Set Without Checks](#l-5-address-state-variable-set-without-checks)
  - [L-6: Public Function Not Used Internally](#l-6-public-function-not-used-internally)
  - [L-7: Literal Instead of Constant](#l-7-literal-instead-of-constant)
  - [L-8: Empty `require()` / `revert()` Statement](#l-8-empty-require--revert-statement)
  - [L-9: PUSH0 Opcode](#l-9-push0-opcode)
  - [L-10: Modifier Invoked Only Once](#l-10-modifier-invoked-only-once)
  - [L-11: Empty Block](#l-11-empty-block)
  - [L-12: Large Numeric Literal](#l-12-large-numeric-literal)
  - [L-13: Internal Function Used Only Once](#l-13-internal-function-used-only-once)
  - [L-14: Contract has TODO Comments](#l-14-contract-has-todo-comments)
  - [L-15: Unused Error](#l-15-unused-error)
  - [L-16: Loop Contains `require`/`revert`](#l-16-loop-contains-requirerevert)
  - [L-17: Unused State Variable](#l-17-unused-state-variable)
  - [L-18: Dead Code](#l-18-dead-code)
  - [L-19: Costly operations inside loop](#l-19-costly-operations-inside-loop)
  - [L-20: Unused Import](#l-20-unused-import)
  - [L-21: State Change Without Event](#l-21-state-change-without-event)
  - [L-22: Unchecked Return](#l-22-unchecked-return)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 62 |
| Total nSLOC | 6807 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/adapters/SmartAdapterAccount.sol | 16 |
| src/adapters/VaultAdapter.sol | 98 |
| src/adapters/parameters/ERC20ExecutionValidator.sol | 88 |
| src/base/ERC2771Context.sol | 56 |
| src/base/ERC3009.sol | 115 |
| src/base/MultiFacetProxy.sol | 51 |
| src/base/kBase.sol | 133 |
| src/base/kBaseRoles.sol | 73 |
| src/constants/Constants.sol | 7 |
| src/errors/Errors.sol | 158 |
| src/interfaces/IERC2771.sol | 6 |
| src/interfaces/IERC7540.sol | 30 |
| src/interfaces/IExtsload.sol | 6 |
| src/interfaces/IRegistry.sol | 342 |
| src/interfaces/IVault.sol | 40 |
| src/interfaces/IVaultAdapter.sol | 11 |
| src/interfaces/IVaultBatch.sol | 6 |
| src/interfaces/IVaultClaim.sol | 5 |
| src/interfaces/IVaultFees.sol | 9 |
| src/interfaces/IVersioned.sol | 5 |
| src/interfaces/IkAssetRouter.sol | 112 |
| src/interfaces/IkBatchReceiver.sol | 12 |
| src/interfaces/IkMinter.sol | 63 |
| src/interfaces/IkRegistry.sol | 4 |
| src/interfaces/IkRemoteRegistry.sol | 12 |
| src/interfaces/IkStakingVault.sol | 15 |
| src/interfaces/IkToken.sol | 30 |
| src/interfaces/IkTokenFactory.sol | 24 |
| src/interfaces/modules/IExecutionGuardian.sol | 288 |
| src/interfaces/modules/IModule.sol | 4 |
| src/interfaces/modules/IVaultReader.sol | 76 |
| src/kAssetRouter.sol | 429 |
| src/kBatchReceiver.sol | 70 |
| src/kMinter.sol | 317 |
| src/kRegistry/kRegistry.sol | 440 |
| src/kRegistry/kRemoteRegistry.sol | 116 |
| src/kRegistry/modules/ExecutionGuardianModule.sol | 119 |
| src/kStakingVault/base/BaseVault.sol | 216 |
| src/kStakingVault/kStakingVault.sol | 341 |
| src/kStakingVault/modules/ReaderModule.sol | 308 |
| src/kStakingVault/types/BaseVaultTypes.sol | 34 |
| src/kToken.sol | 202 |
| src/kTokenFactory.sol | 52 |
| src/vendor/openzeppelin/Proxy.sol | 20 |
| src/vendor/solady/auth/OptimizedOwnableRoles.sol | 176 |
| src/vendor/solady/auth/Ownable.sol | 127 |
| src/vendor/solady/tokens/ERC20.sol | 355 |
| src/vendor/solady/utils/ERC1967Factory.sol | 181 |
| src/vendor/solady/utils/EnumerableSetLib/OptimizedAddressEnumerableSetLib.sol | 250 |
| src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol | 212 |
| src/vendor/solady/utils/Initializable.sol | 96 |
| src/vendor/solady/utils/Multicallable.sol | 58 |
| src/vendor/solady/utils/OptimizedDateTimeLib.sol | 61 |
| src/vendor/solady/utils/OptimizedEfficientHashLib.sol | 49 |
| src/vendor/solady/utils/OptimizedFixedPointMathLib.sol | 45 |
| src/vendor/solady/utils/OptimizedLibCall.sol | 23 |
| src/vendor/solady/utils/OptimizedLibClone.sol | 20 |
| src/vendor/solady/utils/OptimizedReentrancyGuardTransient.sol | 21 |
| src/vendor/solady/utils/OptimizedSafeCastLib.sol | 22 |
| src/vendor/solady/utils/SafeTransferLib.sol | 427 |
| src/vendor/solady/utils/UUPSUpgradeable.sol | 79 |
| src/vendor/uniswap/Extsload.sol | 46 |
| **Total** | **6807** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 7 |
| Low | 22 |


# High Issues

## H-1: Arbitrary `from` Passed to `transferFrom`

Passing an arbitrary `from` address to `transferFrom` (or `safeTransferFrom`) can lead to loss of funds, because anyone can transfer tokens from the `from` address if an approval is made.

<details><summary>1 Found Instances</summary>


- Found in src/kToken.sol [Line: 210](src/kToken.sol#L210)

	```solidity
	        return ERC20.transferFrom(_from, _to, _amount);
	```

</details>



## H-2: Unprotected initializer

Consider protecting the initializer functions with modifiers.

<details><summary>1 Found Instances</summary>


- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 272](src/vendor/solady/utils/ERC1967Factory.sol#L272)

	```solidity
	    function initCodeHash() public view returns (bytes32 result) {
	```

</details>



## H-3: Incorrect Assembly Shift Parameter Order

Example: `shl(shifted, 4)` will shift the right constant `4` by `a` bits. The correct order is `shl(4, shifted)`.

<details><summary>3 Found Instances</summary>


- Found in src/vendor/solady/auth/OptimizedOwnableRoles.sol [Line: 162](src/vendor/solady/auth/OptimizedOwnableRoles.sol#L162)

	```solidity
	                roles := or(shl(mload(add(ordinals, i)), 1), roles)
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 40](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L40)

	```solidity
	            month := byte(mp, shl(160, 0x030405060708090a0b0c0102))
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 92](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L92)

	```solidity
	            result := add(byte(month, shl(152, 0x1f1c1f1e1f1e1f1f1e1f1e1f)), and(eq(month, 2), flag))
	```

</details>



## H-4: Contract Name Reused in Different Files

When compiling contracts with certain development frameworks (for example: Truffle), having contracts with the same name across different files can lead to one being overwritten.

<details><summary>5 Found Instances</summary>


- Found in src/interfaces/IRegistry.sol [Line: 10](src/interfaces/IRegistry.sol#L10)

	```solidity
	interface IRegistry is IVersioned {
	```

- Found in src/vendor/solady/auth/Ownable.sol [Line: 14](src/vendor/solady/auth/Ownable.sol#L14)

	```solidity
	abstract contract Ownable {
	```

- Found in src/vendor/solady/utils/Initializable.sol [Line: 8](src/vendor/solady/utils/Initializable.sol#L8)

	```solidity
	abstract contract Initializable {
	```

- Found in src/vendor/solady/utils/UUPSUpgradeable.sol [Line: 6](src/vendor/solady/utils/UUPSUpgradeable.sol#L6)

	```solidity
	contract CallContextChecker {
	```

- Found in src/vendor/solady/utils/UUPSUpgradeable.sol [Line: 112](src/vendor/solady/utils/UUPSUpgradeable.sol#L112)

	```solidity
	abstract contract UUPSUpgradeable is CallContextChecker {
	```

</details>



## H-5: Yul block contains `return`

This causes the transaction execution to halt, and nothing after that call will execute including code following the assembly block.

<details><summary>5 Found Instances</summary>


- Found in src/vendor/openzeppelin/Proxy.sol [Line: 39](src/vendor/openzeppelin/Proxy.sol#L39)

	```solidity
	            default { return(0, returndatasize()) }
	```

- Found in src/vendor/solady/utils/Multicallable.sol [Line: 104](src/vendor/solady/utils/Multicallable.sol#L104)

	```solidity
	            return(and(0xffffffffffffffff, results), shr(64, results))
	```

- Found in src/vendor/uniswap/Extsload.sol [Line: 15](src/vendor/uniswap/Extsload.sol#L15)

	```solidity
	            return(0, 0x20)
	```

- Found in src/vendor/uniswap/Extsload.sol [Line: 35](src/vendor/uniswap/Extsload.sol#L35)

	```solidity
	            return(start, sub(end, start))
	```

- Found in src/vendor/uniswap/Extsload.sol [Line: 55](src/vendor/uniswap/Extsload.sol#L55)

	```solidity
	            return(start, sub(end, start))
	```

</details>



## H-6: Contract locks Ether without a withdraw function

It appears that the contract includes a payable function to accept Ether but lacks a corresponding function to withdraw it, which leads to the Ether being locked in the contract. To resolve this issue, please implement a public or external function that allows for the withdrawal of Ether from the contract.

<details><summary>7 Found Instances</summary>


- Found in src/adapters/SmartAdapterAccount.sol [Line: 20](src/adapters/SmartAdapterAccount.sol#L20)

	```solidity
	contract SmartAdapterAccount is MinimalSmartAccount {
	```

- Found in src/adapters/VaultAdapter.sol [Line: 24](src/adapters/VaultAdapter.sol#L24)

	```solidity
	contract VaultAdapter is SmartAdapterAccount, IVaultAdapter {
	```

- Found in src/base/kBaseRoles.sol [Line: 15](src/base/kBaseRoles.sol#L15)

	```solidity
	contract kBaseRoles is OptimizedOwnableRoles {
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 24](src/kRegistry/kRemoteRegistry.sol#L24)

	```solidity
	contract kRemoteRegistry is IkRemoteRegistry, Initializable, UUPSUpgradeable, Ownable {
	```

- Found in src/kRegistry/modules/ExecutionGuardianModule.sol [Line: 22](src/kRegistry/modules/ExecutionGuardianModule.sol#L22)

	```solidity
	contract ExecutionGuardianModule is IExecutionGuardian, IModule, kBaseRoles {
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 60](src/kStakingVault/kStakingVault.sol#L60)

	```solidity
	contract kStakingVault is IVault, BaseVault, Initializable, UUPSUpgradeable, Ownable, MultiFacetProxy {
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 7](src/vendor/solady/utils/ERC1967Factory.sol#L7)

	```solidity
	contract ERC1967Factory {
	```

</details>



## H-7: Reentrancy: State change after external call

Changing state after an external call can lead to re-entrancy attacks.Use the checks-effects-interactions pattern to avoid this issue.

<details><summary>13 Found Instances</summary>


- Found in src/adapters/VaultAdapter.sol [Line: 73](src/adapters/VaultAdapter.sol#L73)

	State is changed at: `$.paused = _paused`
	```solidity
	        require(
	```

- Found in src/kAssetRouter.sol [Line: 168](src/kAssetRouter.sol#L168)

	State is changed at: `$.vaultBatchBalances[_kMinter][_batchId].deposited += _amount.toUint128()`
	```solidity
	        IVaultAdapter _adapter = IVaultAdapter(_registry().getAdapter(_kMinter, _asset));
	```

- Found in src/kAssetRouter.sol [Line: 283](src/kAssetRouter.sol#L283)

	State is changed at: `$.settlementProposals[_proposalId] = VaultSettlementProposal({
            asset: _asset,
            vault: _vault,
            batchId: _batchId,
            totalAssets: _totalAssetsAdjusted,
            netted: _netted,
            yield: _yield,
            executeAfter: _executeAfter.toUint64(),
            lastFeesChargedManagement: _lastFeesChargedManagement,
            lastFeesChargedPerformance: _lastFeesChargedPerformance
        })`, `$.proposalCounter++`
	```solidity
	        require(IkMinter(_vault).isClosed(_batchId), KASSETROUTER_NOT_BATCH_CLOSED);
	```

- Found in src/kAssetRouter.sol [Line: 309](src/kAssetRouter.sol#L309)

	State is changed at: `$.settlementProposals[_proposalId] = VaultSettlementProposal({
            asset: _asset,
            vault: _vault,
            batchId: _batchId,
            totalAssets: _totalAssetsAdjusted,
            netted: _netted,
            yield: _yield,
            executeAfter: _executeAfter.toUint64(),
            lastFeesChargedManagement: _lastFeesChargedManagement,
            lastFeesChargedPerformance: _lastFeesChargedPerformance
        })`
	```solidity
	            uint256 _totalSupply = IkStakingVault(_vault).totalSupply();
	```

- Found in src/kMinter.sol [Line: 149](src/kMinter.sol#L149)

	State is changed at: `$.totalLockedAssets[_asset] += _amount`
	```solidity
	        require(
	```

- Found in src/kMinter.sol [Line: 190](src/kMinter.sol#L190)

	State is changed at: `$.burnRequests[_requestId] = BurnRequest({
            user: msg.sender,
            amount: _amount,
            asset: _asset,
            requestTimestamp: block.timestamp.toUint64(),
            status: RequestStatus.PENDING,
            batchId: _batchId,
            recipient: _to
        })`
	```solidity
	        require(
	```

- Found in src/kRegistry/kRegistry.sol [Line: 364](src/kRegistry/kRegistry.sol#L364)

	State is changed at: `$.maxMintPerBatch[_asset] = _maxMintPerBatch`, `$.maxBurnPerBatch[_asset] = _maxBurnPerBatch`, `$.assetToKToken[_asset] = _kToken`
	```solidity
	        _kToken = IkTokenFactory(_factory)
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 123](src/kStakingVault/kStakingVault.sol#L123)

	State is changed at: `$.receiverImplementation = address(new kBatchReceiver(_registry().getContractById(K_MINTER)))`, `$.maxTotalAssets = _maxTotalAssets`
	```solidity
	        $.kToken = _registry().assetToKToken(_asset);
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 124](src/kStakingVault/kStakingVault.sol#L124)

	State is changed at: `$.maxTotalAssets = _maxTotalAssets`
	```solidity
	        $.receiverImplementation = address(new kBatchReceiver(_registry().getContractById(K_MINTER)));
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 146](src/kStakingVault/kStakingVault.sol#L146)

	State is changed at: `require(
            ($.batches[_batchId].depositedInBatch += _amount128) <= _registry().getMaxMintPerBatch(address(this)),
            KSTAKINGVAULT_BATCH_LIMIT_REACHED
        )`, `$.totalPendingStake += _amount.toUint128()`, `$.stakeRequests[_requestId] = BaseVaultTypes.StakeRequest({
            user: _msgSender(),
            kTokenAmount: _amount128,
            recipient: _to,
            requestTimestamp: block.timestamp.toUint64(),
            status: BaseVaultTypes.RequestStatus.PENDING,
            batchId: _batchId
        })`
	```solidity
	        require(_kToken.balanceOf(_msgSender()) >= _amount, KSTAKINGVAULT_INSUFFICIENT_BALANCE);
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 152](src/kStakingVault/kStakingVault.sol#L152)

	State is changed at: `$.totalPendingStake += _amount.toUint128()`, `$.stakeRequests[_requestId] = BaseVaultTypes.StakeRequest({
            user: _msgSender(),
            kTokenAmount: _amount128,
            recipient: _to,
            requestTimestamp: block.timestamp.toUint64(),
            status: BaseVaultTypes.RequestStatus.PENDING,
            batchId: _batchId
        })`
	```solidity
	        require(
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 166](src/kStakingVault/kStakingVault.sol#L166)

	State is changed at: `$.totalPendingStake += _amount.toUint128()`, `$.stakeRequests[_requestId] = BaseVaultTypes.StakeRequest({
            user: _msgSender(),
            kTokenAmount: _amount128,
            recipient: _to,
            requestTimestamp: block.timestamp.toUint64(),
            status: BaseVaultTypes.RequestStatus.PENDING,
            batchId: _batchId
        })`
	```solidity
	        IkAssetRouter(_getKAssetRouter())
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 210](src/kStakingVault/kStakingVault.sol#L210)

	State is changed at: `$.unstakeRequests[_requestId] = BaseVaultTypes.UnstakeRequest({
            user: _msgSender(),
            stkTokenAmount: _stkTokenAmount.toUint128(),
            recipient: _to,
            requestTimestamp: uint64(block.timestamp),
            status: BaseVaultTypes.RequestStatus.PENDING,
            batchId: _batchId
        })`
	```solidity
	        require(
	```

</details>



# Low Issues

## L-1: Centralization Risk

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>14 Found Instances</summary>


- Found in src/kAssetRouter.sol [Line: 55](src/kAssetRouter.sol#L55)

	```solidity
	contract kAssetRouter is IkAssetRouter, Initializable, UUPSUpgradeable, kBase, Ownable {
	```

- Found in src/kMinter.sol [Line: 53](src/kMinter.sol#L53)

	```solidity
	contract kMinter is IkMinter, Initializable, UUPSUpgradeable, kBase, Extsload, Ownable {
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 24](src/kRegistry/kRemoteRegistry.sol#L24)

	```solidity
	contract kRemoteRegistry is IkRemoteRegistry, Initializable, UUPSUpgradeable, Ownable {
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 87](src/kRegistry/kRemoteRegistry.sol#L87)

	```solidity
	        onlyOwner
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 121](src/kRegistry/kRemoteRegistry.sol#L121)

	```solidity
	        onlyOwner
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 60](src/kStakingVault/kStakingVault.sol#L60)

	```solidity
	contract kStakingVault is IVault, BaseVault, Initializable, UUPSUpgradeable, Ownable, MultiFacetProxy {
	```

- Found in src/kToken.sol [Line: 290](src/kToken.sol#L290)

	```solidity
	    function grantAdminRole(address _admin) external onlyOwner {
	```

- Found in src/kToken.sol [Line: 298](src/kToken.sol#L298)

	```solidity
	    function revokeAdminRole(address _admin) external onlyOwner {
	```

- Found in src/vendor/solady/auth/OptimizedOwnableRoles.sol [Line: 11](src/vendor/solady/auth/OptimizedOwnableRoles.sol#L11)

	```solidity
	abstract contract OptimizedOwnableRoles is Ownable {
	```

- Found in src/vendor/solady/auth/OptimizedOwnableRoles.sol [Line: 202](src/vendor/solady/auth/OptimizedOwnableRoles.sol#L202)

	```solidity
	    function grantRoles(address user, uint256 roles) public payable virtual onlyOwner {
	```

- Found in src/vendor/solady/auth/OptimizedOwnableRoles.sol [Line: 208](src/vendor/solady/auth/OptimizedOwnableRoles.sol#L208)

	```solidity
	    function revokeRoles(address user, uint256 roles) public payable virtual onlyOwner {
	```

- Found in src/vendor/solady/auth/Ownable.sol [Line: 173](src/vendor/solady/auth/Ownable.sol#L173)

	```solidity
	    function transferOwnership(address newOwner) public payable virtual onlyOwner {
	```

- Found in src/vendor/solady/auth/Ownable.sol [Line: 185](src/vendor/solady/auth/Ownable.sol#L185)

	```solidity
	    function renounceOwnership() public payable virtual onlyOwner {
	```

- Found in src/vendor/solady/auth/Ownable.sol [Line: 221](src/vendor/solady/auth/Ownable.sol#L221)

	```solidity
	    function completeOwnershipHandover(address pendingOwner) public payable virtual onlyOwner {
	```

</details>



## L-2: `ecrecover` Signature Malleability

The `ecrecover` function is susceptible to signature malleability. This means that the same message can be signed in multiple ways, allowing an attacker to change the message signature without invalidating it. This can lead to unexpected behavior in smart contracts, such as the loss of funds or the ability to bypass access control. Consider using OpenZeppelin's ECDSA library instead of the built-in function.

<details><summary>1 Found Instances</summary>


- Found in src/base/ERC3009.sol [Line: 243](src/base/ERC3009.sol#L243)

	```solidity
	        address recoveredAddress = ecrecover(digest, v, r, s);
	```

</details>



## L-3: Unsafe ERC20 Operation

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

<details><summary>6 Found Instances</summary>


- Found in src/adapters/parameters/ERC20ExecutionValidator.sol [Line: 121](src/adapters/parameters/ERC20ExecutionValidator.sol#L121)

	```solidity
	        if (_selector == ERC20.transfer.selector) {
	```

- Found in src/adapters/parameters/ERC20ExecutionValidator.sol [Line: 126](src/adapters/parameters/ERC20ExecutionValidator.sol#L126)

	```solidity
	        } else if (_selector == ERC20.transferFrom.selector) {
	```

- Found in src/adapters/parameters/ERC20ExecutionValidator.sol [Line: 132](src/adapters/parameters/ERC20ExecutionValidator.sol#L132)

	```solidity
	        } else if (_selector == ERC20.approve.selector) {
	```

- Found in src/kToken.sol [Line: 184](src/kToken.sol#L184)

	```solidity
	        return ERC20.approve(_spender, _amount);
	```

- Found in src/kToken.sol [Line: 192](src/kToken.sol#L192)

	```solidity
	        return ERC20.transfer(_to, _amount);
	```

- Found in src/kToken.sol [Line: 210](src/kToken.sol#L210)

	```solidity
	        return ERC20.transferFrom(_from, _to, _amount);
	```

</details>



## L-4: Unspecific Solidity Pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>21 Found Instances</summary>


- Found in src/adapters/SmartAdapterAccount.sol [Line: 2](src/adapters/SmartAdapterAccount.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IERC2771.sol [Line: 2](src/interfaces/IERC2771.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IERC7540.sol [Line: 2](src/interfaces/IERC7540.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IExtsload.sol [Line: 2](src/interfaces/IExtsload.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IRegistry.sol [Line: 2](src/interfaces/IRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVault.sol [Line: 2](src/interfaces/IVault.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultAdapter.sol [Line: 2](src/interfaces/IVaultAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultBatch.sol [Line: 2](src/interfaces/IVaultBatch.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultClaim.sol [Line: 2](src/interfaces/IVaultClaim.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultFees.sol [Line: 2](src/interfaces/IVaultFees.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVersioned.sol [Line: 2](src/interfaces/IVersioned.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkAssetRouter.sol [Line: 2](src/interfaces/IkAssetRouter.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkBatchReceiver.sol [Line: 2](src/interfaces/IkBatchReceiver.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkMinter.sol [Line: 2](src/interfaces/IkMinter.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkRegistry.sol [Line: 2](src/interfaces/IkRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkStakingVault.sol [Line: 2](src/interfaces/IkStakingVault.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkToken.sol [Line: 2](src/interfaces/IkToken.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkTokenFactory.sol [Line: 2](src/interfaces/IkTokenFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/modules/IExecutionGuardian.sol [Line: 2](src/interfaces/modules/IExecutionGuardian.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/modules/IModule.sol [Line: 2](src/interfaces/modules/IModule.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/modules/IVaultReader.sol [Line: 2](src/interfaces/modules/IVaultReader.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

</details>



## L-5: Address State Variable Set Without Checks

Check for `address(0)` when assigning values to address state variables.

<details><summary>1 Found Instances</summary>


- Found in src/kBatchReceiver.sol [Line: 98](src/kBatchReceiver.sol#L98)

	```solidity
	        asset = _asset;
	```

</details>



## L-6: Public Function Not Used Internally

If a function is marked public but is not used internally, consider marking it as `external`.

<details><summary>8 Found Instances</summary>


- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 116](src/kStakingVault/modules/ReaderModule.sol#L116)

	```solidity
	    function lastFeesChargedManagement() public view returns (uint256) {
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 122](src/kStakingVault/modules/ReaderModule.sol#L122)

	```solidity
	    function lastFeesChargedPerformance() public view returns (uint256) {
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 76](src/vendor/solady/utils/ERC1967Factory.sol#L76)

	```solidity
	    function adminOf(address proxy) public view returns (address admin) {
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 84](src/vendor/solady/utils/ERC1967Factory.sol#L84)

	```solidity
	    function changeAdmin(address proxy, address admin) public {
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 104](src/vendor/solady/utils/ERC1967Factory.sol#L104)

	```solidity
	    function upgrade(address proxy, address implementation) public payable {
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 146](src/vendor/solady/utils/ERC1967Factory.sol#L146)

	```solidity
	    function deploy(address implementation, address admin) public payable returns (address proxy) {
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 169](src/vendor/solady/utils/ERC1967Factory.sol#L169)

	```solidity
	    function deployDeterministic(
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 253](src/vendor/solady/utils/ERC1967Factory.sol#L253)

	```solidity
	    function predictDeterministicAddress(bytes32 salt) public view returns (address predicted) {
	```

</details>



## L-7: Literal Instead of Constant

Define and use `constant` variables instead of using literals. If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>30 Found Instances</summary>


- Found in src/kStakingVault/base/BaseVault.sol [Line: 367](src/kStakingVault/base/BaseVault.sol#L367)

	```solidity
	        return _convertToAssetsWithTotals(10 ** _getDecimals($), _totalNetAssets(), totalSupply());
	```

- Found in src/kStakingVault/base/BaseVault.sol [Line: 381](src/kStakingVault/base/BaseVault.sol#L381)

	```solidity
	        return _convertToAssetsWithTotals(10 ** _getDecimals($), _totalAssets(), totalSupply());
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 64](src/kStakingVault/modules/ReaderModule.sol#L64)

	```solidity
	        uint256 _lastTotalAssets = totalSupply().fullMulDiv(_lastSharePrice, 10 ** _getDecimals($));
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 160](src/kStakingVault/modules/ReaderModule.sol#L160)

	```solidity
	        if (_targetMonth > 12) {
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 161](src/kStakingVault/modules/ReaderModule.sol#L161)

	```solidity
	            _targetYear += (_targetMonth - 1) / 12;
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 162](src/kStakingVault/modules/ReaderModule.sol#L162)

	```solidity
	            _targetMonth = ((_targetMonth - 1) % 12) + 1;
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 169](src/kStakingVault/modules/ReaderModule.sol#L169)

	```solidity
	        return OptimizedDateTimeLib.dateTimeToTimestamp(_targetYear, _targetMonth, _lastDay, 23, 59, 59);
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 183](src/kStakingVault/modules/ReaderModule.sol#L183)

	```solidity
	        if (_day != _lastDay) return OptimizedDateTimeLib.dateTimeToTimestamp(_year, _month, _lastDay, 23, 59, 59);
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 190](src/kStakingVault/modules/ReaderModule.sol#L190)

	```solidity
	        if (_targetMonth > 12) {
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 199](src/kStakingVault/modules/ReaderModule.sol#L199)

	```solidity
	        return OptimizedDateTimeLib.dateTimeToTimestamp(_targetYear, _targetMonth, _lastDay, 23, 59, 59);
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 258](src/kStakingVault/modules/ReaderModule.sol#L258)

	```solidity
	        sharePrice_ = _convertToSharesWithTotals(10 ** decimals, batch.totalAssets, _totalSupply);
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 259](src/kStakingVault/modules/ReaderModule.sol#L259)

	```solidity
	        netSharePrice_ = _convertToSharesWithTotals(10 ** decimals, batch.totalNetAssets, _totalSupply);
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 49](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L49)

	```solidity
	        (year, month, day) = epochDayToDate(timestamp / 86_400);
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 62](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L62)

	```solidity
	            result = dateToEpochDay(year, month, day) * 86_400 + hour * 3600 + minute * 60 + second;
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 76](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L76)

	```solidity
	            (year, month, day) = epochDayToDate(timestamp / 86_400);
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 77](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L77)

	```solidity
	            uint256 secs = timestamp % 86_400;
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 78](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L78)

	```solidity
	            hour = secs / 3600;
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 79](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L79)

	```solidity
	            secs = secs % 3600;
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 80](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L80)

	```solidity
	            minute = secs / 60;
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 81](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L81)

	```solidity
	            second = secs % 60;
	```

- Found in src/vendor/solady/utils/OptimizedFixedPointMathLib.sol [Line: 87](src/vendor/solady/utils/OptimizedFixedPointMathLib.sol#L87)

	```solidity
	            z = (uint256(x) + uint256(x >> 255)) ^ uint256(x >> 255);
	```

</details>



## L-8: Empty `require()` / `revert()` Statement

Use descriptive reason strings or custom errors for revert paths.

<details><summary>5 Found Instances</summary>


- Found in src/adapters/VaultAdapter.sol [Line: 150](src/adapters/VaultAdapter.sol#L150)

	```solidity
	        require(
	```

- Found in src/base/MultiFacetProxy.sol [Line: 59](src/base/MultiFacetProxy.sol#L59)

	```solidity
	            if ($.selectorToImplementation[_selector] != address(0)) revert();
	```

- Found in src/base/MultiFacetProxy.sol [Line: 106](src/base/MultiFacetProxy.sol#L106)

	```solidity
	        if (_impl == address(0)) revert();
	```

- Found in src/vendor/solady/utils/Initializable.sol [Line: 49](src/vendor/solady/utils/Initializable.sol#L49)

	```solidity
	        require(_initializableSlot() != bytes32(0));
	```

- Found in src/vendor/solady/utils/Multicallable.sol [Line: 34](src/vendor/solady/utils/Multicallable.sol#L34)

	```solidity
	        if (msg.value != 0) revert();
	```

</details>



## L-9: PUSH0 Opcode

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>22 Found Instances</summary>


- Found in src/adapters/SmartAdapterAccount.sol [Line: 2](src/adapters/SmartAdapterAccount.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IERC2771.sol [Line: 2](src/interfaces/IERC2771.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IERC7540.sol [Line: 2](src/interfaces/IERC7540.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IExtsload.sol [Line: 2](src/interfaces/IExtsload.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IRegistry.sol [Line: 2](src/interfaces/IRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVault.sol [Line: 2](src/interfaces/IVault.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultAdapter.sol [Line: 2](src/interfaces/IVaultAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultBatch.sol [Line: 2](src/interfaces/IVaultBatch.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultClaim.sol [Line: 2](src/interfaces/IVaultClaim.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVaultFees.sol [Line: 2](src/interfaces/IVaultFees.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IVersioned.sol [Line: 2](src/interfaces/IVersioned.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkAssetRouter.sol [Line: 2](src/interfaces/IkAssetRouter.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkBatchReceiver.sol [Line: 2](src/interfaces/IkBatchReceiver.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkMinter.sol [Line: 2](src/interfaces/IkMinter.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkRegistry.sol [Line: 2](src/interfaces/IkRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkStakingVault.sol [Line: 2](src/interfaces/IkStakingVault.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkToken.sol [Line: 2](src/interfaces/IkToken.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/IkTokenFactory.sol [Line: 2](src/interfaces/IkTokenFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/modules/IExecutionGuardian.sol [Line: 2](src/interfaces/modules/IExecutionGuardian.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/modules/IModule.sol [Line: 2](src/interfaces/modules/IModule.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/interfaces/modules/IVaultReader.sol [Line: 2](src/interfaces/modules/IVaultReader.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 2](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

</details>



## L-10: Modifier Invoked Only Once

Consider removing the modifier or inlining the logic into the calling function.

<details><summary>2 Found Instances</summary>


- Found in src/vendor/solady/utils/UUPSUpgradeable.sol [Line: 77](src/vendor/solady/utils/UUPSUpgradeable.sol#L77)

	```solidity
	    modifier onlyProxy() virtual {
	```

- Found in src/vendor/solady/utils/UUPSUpgradeable.sol [Line: 84](src/vendor/solady/utils/UUPSUpgradeable.sol#L84)

	```solidity
	    modifier notDelegated() virtual {
	```

</details>



## L-11: Empty Block

Consider removing empty blocks.

<details><summary>4 Found Instances</summary>


- Found in src/vendor/solady/auth/Ownable.sol [Line: 84](src/vendor/solady/auth/Ownable.sol#L84)

	```solidity
	    function _guardInitializeOwner() internal pure virtual returns (bool guard) { }
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 348](src/vendor/solady/tokens/ERC20.sol#L348)

	```solidity
	    function _constantNameHash() internal view virtual returns (bytes32 result) { }
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 648](src/vendor/solady/tokens/ERC20.sol#L648)

	```solidity
	    function _beforeTokenTransfer(address from, address to, uint256 amount) internal virtual { }
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 652](src/vendor/solady/tokens/ERC20.sol#L652)

	```solidity
	    function _afterTokenTransfer(address from, address to, uint256 amount) internal virtual { }
	```

</details>



## L-12: Large Numeric Literal

Large literal values multiples of 10000 can be replaced with scientific notation.Use `e` notation, for example: `1e18`, instead of its full numeric value.

<details><summary>3 Found Instances</summary>


- Found in src/constants/Constants.sol [Line: 40](src/constants/Constants.sol#L40)

	```solidity
	uint256 constant MAX_BPS = 10_000;
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 439](src/kStakingVault/kStakingVault.sol#L439)

	```solidity
	        require(_bps <= 10_000, VAULTFEES_FEE_EXCEEDS_MAXIMUM);
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 52](src/vendor/solady/utils/SafeTransferLib.sol#L52)

	```solidity
	    uint256 internal constant GAS_STIPEND_NO_GRIEF = 100_000;
	```

</details>



## L-13: Internal Function Used Only Once

Instead of separating the logic into a separate function, consider inlining the logic into the calling function. This can reduce the number of function calls and improve readability.

<details><summary>10 Found Instances</summary>


- Found in src/vendor/solady/utils/EnumerableSetLib/OptimizedAddressEnumerableSetLib.sol [Line: 77](src/vendor/solady/utils/EnumerableSetLib/OptimizedAddressEnumerableSetLib.sol#L77)

	```solidity
	    function length(AddressSet storage set) internal view returns (uint256 result) {
	```

- Found in src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol [Line: 107](src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol#L107)

	```solidity
	    function add(Bytes32Set storage set, bytes32 value) internal returns (bool result) {
	```

- Found in src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol [Line: 165](src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol#L165)

	```solidity
	    function add(Bytes32Set storage set, bytes32 value, uint256 cap) internal returns (bool result) {
	```

- Found in src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol [Line: 170](src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol#L170)

	```solidity
	    function remove(Bytes32Set storage set, bytes32 value) internal returns (bool result) {
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 17](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L17)

	```solidity
	    function dateToEpochDay(uint256 year, uint256 month, uint256 day) internal pure returns (uint256 epochDay) {
	```

- Found in src/vendor/solady/utils/OptimizedDateTimeLib.sol [Line: 97](src/vendor/solady/utils/OptimizedDateTimeLib.sol#L97)

	```solidity
	    function isLeapYear(uint256 year) internal pure returns (bool leap) {
	```

- Found in src/vendor/solady/utils/OptimizedLibClone.sol [Line: 32](src/vendor/solady/utils/OptimizedLibClone.sol#L32)

	```solidity
	    function clone(uint256 value, address implementation) internal returns (address instance) {
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 221](src/vendor/solady/utils/SafeTransferLib.sol#L221)

	```solidity
	    function trySafeTransferFrom(
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 446](src/vendor/solady/utils/SafeTransferLib.sol#L446)

	```solidity
	    function permit2TransferFrom(address token, address from, address to, uint256 amount) internal {
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 530](src/vendor/solady/utils/SafeTransferLib.sol#L530)

	```solidity
	    function simplePermit2(
	```

</details>



## L-14: Contract has TODO Comments

Contract contains comments with TODOS. Consider implementing or removing them.

<details><summary>1 Found Instances</summary>


- Found in src/kAssetRouter.sol [Line: 55](src/kAssetRouter.sol#L55)

	```solidity
	contract kAssetRouter is IkAssetRouter, Initializable, UUPSUpgradeable, kBase, Ownable {
	```

</details>



## L-15: Unused Error

Consider using or removing the unused error.

<details><summary>37 Found Instances</summary>


- Found in src/vendor/solady/auth/Ownable.sol [Line: 20](src/vendor/solady/auth/Ownable.sol#L20)

	```solidity
	    error Unauthorized();
	```

- Found in src/vendor/solady/auth/Ownable.sol [Line: 23](src/vendor/solady/auth/Ownable.sol#L23)

	```solidity
	    error NewOwnerIsZeroAddress();
	```

- Found in src/vendor/solady/auth/Ownable.sol [Line: 26](src/vendor/solady/auth/Ownable.sol#L26)

	```solidity
	    error NoHandoverRequest();
	```

- Found in src/vendor/solady/auth/Ownable.sol [Line: 29](src/vendor/solady/auth/Ownable.sol#L29)

	```solidity
	    error AlreadyInitialized();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 28](src/vendor/solady/tokens/ERC20.sol#L28)

	```solidity
	    error TotalSupplyOverflow();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 31](src/vendor/solady/tokens/ERC20.sol#L31)

	```solidity
	    error AllowanceOverflow();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 34](src/vendor/solady/tokens/ERC20.sol#L34)

	```solidity
	    error AllowanceUnderflow();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 37](src/vendor/solady/tokens/ERC20.sol#L37)

	```solidity
	    error InsufficientBalance();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 40](src/vendor/solady/tokens/ERC20.sol#L40)

	```solidity
	    error InsufficientAllowance();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 43](src/vendor/solady/tokens/ERC20.sol#L43)

	```solidity
	    error InvalidPermit();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 46](src/vendor/solady/tokens/ERC20.sol#L46)

	```solidity
	    error PermitExpired();
	```

- Found in src/vendor/solady/tokens/ERC20.sol [Line: 49](src/vendor/solady/tokens/ERC20.sol#L49)

	```solidity
	    error Permit2AllowanceIsFixedAtInfinity();
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 13](src/vendor/solady/utils/ERC1967Factory.sol#L13)

	```solidity
	    error Unauthorized();
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 16](src/vendor/solady/utils/ERC1967Factory.sol#L16)

	```solidity
	    error DeploymentFailed();
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 19](src/vendor/solady/utils/ERC1967Factory.sol#L19)

	```solidity
	    error UpgradeFailed();
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 22](src/vendor/solady/utils/ERC1967Factory.sol#L22)

	```solidity
	    error SaltDoesNotStartWithCaller();
	```

- Found in src/vendor/solady/utils/EnumerableSetLib/OptimizedAddressEnumerableSetLib.sol [Line: 18](src/vendor/solady/utils/EnumerableSetLib/OptimizedAddressEnumerableSetLib.sol#L18)

	```solidity
	    error ValueIsZeroSentinel();
	```

- Found in src/vendor/solady/utils/EnumerableSetLib/OptimizedAddressEnumerableSetLib.sol [Line: 21](src/vendor/solady/utils/EnumerableSetLib/OptimizedAddressEnumerableSetLib.sol#L21)

	```solidity
	    error ExceedsCapacity();
	```

- Found in src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol [Line: 18](src/vendor/solady/utils/EnumerableSetLib/OptimizedBytes32EnumerableSetLib.sol#L18)

	```solidity
	    error ValueIsZeroSentinel();
	```

- Found in src/vendor/solady/utils/Initializable.sol [Line: 14](src/vendor/solady/utils/Initializable.sol#L14)

	```solidity
	    error InvalidInitialization();
	```

- Found in src/vendor/solady/utils/Initializable.sol [Line: 17](src/vendor/solady/utils/Initializable.sol#L17)

	```solidity
	    error NotInitializing();
	```

- Found in src/vendor/solady/utils/OptimizedFixedPointMathLib.sol [Line: 17](src/vendor/solady/utils/OptimizedFixedPointMathLib.sol#L17)

	```solidity
	    error FullMulDivFailed();
	```

- Found in src/vendor/solady/utils/OptimizedLibCall.sol [Line: 16](src/vendor/solady/utils/OptimizedLibCall.sol#L16)

	```solidity
	    error TargetIsNotContract();
	```

- Found in src/vendor/solady/utils/OptimizedLibClone.sol [Line: 19](src/vendor/solady/utils/OptimizedLibClone.sol#L19)

	```solidity
	    error DeploymentFailed();
	```

- Found in src/vendor/solady/utils/OptimizedReentrancyGuardTransient.sol [Line: 15](src/vendor/solady/utils/OptimizedReentrancyGuardTransient.sol#L15)

	```solidity
	    error Reentrancy();
	```

- Found in src/vendor/solady/utils/OptimizedSafeCastLib.sol [Line: 17](src/vendor/solady/utils/OptimizedSafeCastLib.sol#L17)

	```solidity
	    error Overflow();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 17](src/vendor/solady/utils/SafeTransferLib.sol#L17)

	```solidity
	    error ETHTransferFailed();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 20](src/vendor/solady/utils/SafeTransferLib.sol#L20)

	```solidity
	    error TransferFromFailed();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 23](src/vendor/solady/utils/SafeTransferLib.sol#L23)

	```solidity
	    error TransferFailed();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 26](src/vendor/solady/utils/SafeTransferLib.sol#L26)

	```solidity
	    error ApproveFailed();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 29](src/vendor/solady/utils/SafeTransferLib.sol#L29)

	```solidity
	    error TotalSupplyQueryFailed();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 32](src/vendor/solady/utils/SafeTransferLib.sol#L32)

	```solidity
	    error Permit2Failed();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 35](src/vendor/solady/utils/SafeTransferLib.sol#L35)

	```solidity
	    error Permit2AmountOverflow();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 38](src/vendor/solady/utils/SafeTransferLib.sol#L38)

	```solidity
	    error Permit2ApproveFailed();
	```

- Found in src/vendor/solady/utils/SafeTransferLib.sol [Line: 41](src/vendor/solady/utils/SafeTransferLib.sol#L41)

	```solidity
	    error Permit2LockdownFailed();
	```

- Found in src/vendor/solady/utils/UUPSUpgradeable.sol [Line: 12](src/vendor/solady/utils/UUPSUpgradeable.sol#L12)

	```solidity
	    error UnauthorizedCallContext();
	```

- Found in src/vendor/solady/utils/UUPSUpgradeable.sol [Line: 118](src/vendor/solady/utils/UUPSUpgradeable.sol#L118)

	```solidity
	    error UpgradeFailed();
	```

</details>



## L-16: Loop Contains `require`/`revert`

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>1 Found Instances</summary>


- Found in src/base/MultiFacetProxy.sol [Line: 72](src/base/MultiFacetProxy.sol#L72)

	```solidity
	        for (uint256 _i = 0; _i < _selectors.length; _i++) {
	```

</details>



## L-17: Unused State Variable

State variable appears to be unused. No analysis has been performed to see if any inline assembly references it. Consider removing this unused variable.

<details><summary>17 Found Instances</summary>


- Found in src/adapters/VaultAdapter.sol [Line: 44](src/adapters/VaultAdapter.sol#L44)

	```solidity
	    bytes32 private constant VAULTADAPTER_STORAGE_LOCATION =
	```

- Found in src/base/kBase.sol [Line: 93](src/base/kBase.sol#L93)

	```solidity
	    bytes32 private constant KBASE_STORAGE_LOCATION =
	```

- Found in src/base/kBaseRoles.sol [Line: 59](src/base/kBaseRoles.sol#L59)

	```solidity
	    bytes32 private constant KROLESBASE_STORAGE_LOCATION =
	```

- Found in src/kAssetRouter.sol [Line: 112](src/kAssetRouter.sol#L112)

	```solidity
	    bytes32 private constant KASSETROUTER_STORAGE_LOCATION =
	```

- Found in src/kMinter.sol [Line: 88](src/kMinter.sol#L88)

	```solidity
	    bytes32 private constant KMINTER_STORAGE_LOCATION =
	```

- Found in src/kRegistry/kRegistry.sol [Line: 112](src/kRegistry/kRegistry.sol#L112)

	```solidity
	    bytes32 private constant KREGISTRY_STORAGE_LOCATION =
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 44](src/kRegistry/kRemoteRegistry.sol#L44)

	```solidity
	    bytes32 private constant KREMOTEREGISTRY_STORAGE_LOCATION =
	```

- Found in src/kRegistry/modules/ExecutionGuardianModule.sol [Line: 47](src/kRegistry/modules/ExecutionGuardianModule.sol#L47)

	```solidity
	    bytes32 private constant EXECUTIONGUARDIANMODULE_STORAGE_LOCATION =
	```

- Found in src/kToken.sol [Line: 80](src/kToken.sol#L80)

	```solidity
	    bytes32 private constant KTOKEN_STORAGE_LOCATION =
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 25](src/vendor/solady/utils/ERC1967Factory.sol#L25)

	```solidity
	    uint256 internal constant _UNAUTHORIZED_ERROR_SELECTOR = 0x82b42900;
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 28](src/vendor/solady/utils/ERC1967Factory.sol#L28)

	```solidity
	    uint256 internal constant _DEPLOYMENT_FAILED_ERROR_SELECTOR = 0x30116425;
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 31](src/vendor/solady/utils/ERC1967Factory.sol#L31)

	```solidity
	    uint256 internal constant _UPGRADE_FAILED_ERROR_SELECTOR = 0x55299b49;
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 34](src/vendor/solady/utils/ERC1967Factory.sol#L34)

	```solidity
	    uint256 internal constant _SALT_DOES_NOT_START_WITH_CALLER_ERROR_SELECTOR = 0x2f634836;
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 50](src/vendor/solady/utils/ERC1967Factory.sol#L50)

	```solidity
	    uint256 internal constant _ADMIN_CHANGED_EVENT_SIGNATURE =
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 54](src/vendor/solady/utils/ERC1967Factory.sol#L54)

	```solidity
	    uint256 internal constant _UPGRADED_EVENT_SIGNATURE =
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 58](src/vendor/solady/utils/ERC1967Factory.sol#L58)

	```solidity
	    uint256 internal constant _DEPLOYED_EVENT_SIGNATURE =
	```

- Found in src/vendor/solady/utils/ERC1967Factory.sol [Line: 69](src/vendor/solady/utils/ERC1967Factory.sol#L69)

	```solidity
	    uint256 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
	```

</details>



## L-18: Dead Code

Functions that are not used. Consider removing them.

<details><summary>11 Found Instances</summary>


- Found in src/adapters/VaultAdapter.sol [Line: 149](src/adapters/VaultAdapter.sol#L149)

	```solidity
	    function _checkVaultCanCallSelector(address _target, bytes4 _selector) internal view {
	```

- Found in src/adapters/VaultAdapter.sol [Line: 158](src/adapters/VaultAdapter.sol#L158)

	```solidity
	    function _checkZeroAddress(address _addr) internal pure {
	```

- Found in src/base/kBase.sol [Line: 220](src/base/kBase.sol#L220)

	```solidity
	    function _getBatchId(address _vault) internal view returns (bytes32 _batchId) {
	```

- Found in src/base/kBase.sol [Line: 229](src/base/kBase.sol#L229)

	```solidity
	    function _getBatchReceiver(address _vault, bytes32 _batchId) internal view returns (address _batchReceiver) {
	```

- Found in src/base/kBase.sol [Line: 263](src/base/kBase.sol#L263)

	```solidity
	    function _getVaultAssets(address _vault) internal view returns (address[] memory _assets) {
	```

- Found in src/base/kBase.sol [Line: 272](src/base/kBase.sol#L272)

	```solidity
	    function _getDNVaultByAsset(address _asset) internal view returns (address _vault) {
	```

- Found in src/base/kBaseRoles.sol [Line: 132](src/base/kBaseRoles.sol#L132)

	```solidity
	    function _checkGuardian(address _user) internal view {
	```

- Found in src/base/kBaseRoles.sol [Line: 138](src/base/kBaseRoles.sol#L138)

	```solidity
	    function _checkRelayer(address _user) internal view {
	```

- Found in src/base/kBaseRoles.sol [Line: 144](src/base/kBaseRoles.sol#L144)

	```solidity
	    function _checkInstitution(address _user) internal view {
	```

- Found in src/base/kBaseRoles.sol [Line: 156](src/base/kBaseRoles.sol#L156)

	```solidity
	    function _checkManager(address _user) internal view {
	```

- Found in src/vendor/solady/utils/UUPSUpgradeable.sol [Line: 45](src/vendor/solady/utils/UUPSUpgradeable.sol#L45)

	```solidity
	    function _selfImplementation() internal view virtual returns (address) {
	```

</details>



## L-19: Costly operations inside loop

Invoking `SSTORE` operations in loops may waste gas. Use a local variable to hold the loop computation result.

<details><summary>3 Found Instances</summary>


- Found in src/base/MultiFacetProxy.sol [Line: 72](src/base/MultiFacetProxy.sol#L72)

	```solidity
	        for (uint256 _i = 0; _i < _selectors.length; _i++) {
	```

- Found in src/base/MultiFacetProxy.sol [Line: 91](src/base/MultiFacetProxy.sol#L91)

	```solidity
	        for (uint256 _i = 0; _i < _selectors.length; _i++) {
	```

- Found in src/kRegistry/kRegistry.sol [Line: 436](src/kRegistry/kRegistry.sol#L436)

	```solidity
	        for (uint256 i; i < _assets.length; i++) {
	```

</details>



## L-20: Unused Import

Redundant import statement. Consider removing it.

<details><summary>6 Found Instances</summary>


- Found in src/adapters/VaultAdapter.sol [Line: 17](src/adapters/VaultAdapter.sol#L17)

	```solidity
	import { IVersioned } from "kam/src/interfaces/IVersioned.sol";
	```

- Found in src/kAssetRouter.sol [Line: 34](src/kAssetRouter.sol#L34)

	```solidity
	import { IVersioned } from "kam/src/interfaces/IVersioned.sol";
	```

- Found in src/kMinter.sol [Line: 33](src/kMinter.sol#L33)

	```solidity
	import { IVersioned } from "kam/src/interfaces/IVersioned.sol";
	```

- Found in src/kRegistry/kRegistry.sol [Line: 24](src/kRegistry/kRegistry.sol#L24)

	```solidity
	import { IVersioned } from "kam/src/interfaces/IVersioned.sol";
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 16](src/kRegistry/kRemoteRegistry.sol#L16)

	```solidity
	import { IVersioned } from "kam/src/interfaces/IVersioned.sol";
	```

- Found in src/kStakingVault/modules/ReaderModule.sol [Line: 15](src/kStakingVault/modules/ReaderModule.sol#L15)

	```solidity
	import { IVersioned } from "kam/src/interfaces/IVersioned.sol";
	```

</details>



## L-21: State Change Without Event

There are state variable changes in this function but no event is emitted. Consider emitting an event to enable offchain indexers to track the changes.

<details><summary>1 Found Instances</summary>


- Found in src/adapters/parameters/ERC20ExecutionValidator.sol [Line: 112](src/adapters/parameters/ERC20ExecutionValidator.sol#L112)

	```solidity
	    function authorizeCall(
	```

</details>



## L-22: Unchecked Return

Function returns a value but it is ignored. Consider checking the return value.

<details><summary>18 Found Instances</summary>


- Found in src/kAssetRouter.sol [Line: 387](src/kAssetRouter.sol#L387)

	```solidity
	        $.executedProposalIds.add(_proposalId);
	```

- Found in src/kAssetRouter.sol [Line: 412](src/kAssetRouter.sol#L412)

	```solidity
	        $.batchIds.remove(_proposal.batchId);
	```

- Found in src/kMinter.sol [Line: 210](src/kMinter.sol#L210)

	```solidity
	        $.userRequests[msg.sender].add(_requestId);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 345](src/kRegistry/kRegistry.sol#L345)

	```solidity
	        $.supportedAssets.add(_asset);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 401](src/kRegistry/kRegistry.sol#L401)

	```solidity
	        $.vaultAsset[_vault].add(_asset);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 407](src/kRegistry/kRegistry.sol#L407)

	```solidity
	        $.vaultsByAsset[_asset].add(_vault);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 415](src/kRegistry/kRegistry.sol#L415)

	```solidity
	                $.allVaults.add(_vault);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 417](src/kRegistry/kRegistry.sol#L417)

	```solidity
	            IkMinter(_vault).createNewBatch(_asset);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 419](src/kRegistry/kRegistry.sol#L419)

	```solidity
	            $.allVaults.add(_vault);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 439](src/kRegistry/kRegistry.sol#L439)

	```solidity
	            $.vaultsByAsset[_asset].remove(_vault);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 440](src/kRegistry/kRegistry.sol#L440)

	```solidity
	            $.vaultAsset[_vault].remove(_asset);
	```

- Found in src/kRegistry/kRegistry.sol [Line: 444](src/kRegistry/kRegistry.sol#L444)

	```solidity
	        $.allVaults.remove(_vault);
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 103](src/kRegistry/kRemoteRegistry.sol#L103)

	```solidity
	            $.executorTargets[_executor].add(_target);
	```

- Found in src/kRegistry/kRemoteRegistry.sol [Line: 105](src/kRegistry/kRemoteRegistry.sol#L105)

	```solidity
	            $.executorTargets[_executor].remove(_target);
	```

- Found in src/kRegistry/modules/ExecutionGuardianModule.sol [Line: 95](src/kRegistry/modules/ExecutionGuardianModule.sol#L95)

	```solidity
	            $.executorTargets[_executor].add(_target);
	```

- Found in src/kRegistry/modules/ExecutionGuardianModule.sol [Line: 97](src/kRegistry/modules/ExecutionGuardianModule.sol#L97)

	```solidity
	            $.executorTargets[_executor].remove(_target);
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 176](src/kStakingVault/kStakingVault.sol#L176)

	```solidity
	        $.userRequests[_msgSender()].add(_requestId);
	```

- Found in src/kStakingVault/kStakingVault.sol [Line: 229](src/kStakingVault/kStakingVault.sol#L229)

	```solidity
	        $.userRequests[_msgSender()].add(_requestId);
	```

</details>



